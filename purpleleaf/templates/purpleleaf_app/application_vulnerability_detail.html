{% extends 'purpleleaf_app/base.html' %}
{% block title %}
    <title>Application Vulnerability Details - {{title}}</title>
{% endblock %}

{% block content %}
<!-- Dashboard Wrapper Start -->
<div class="dashboard-wrapper dashboard-wrapper-lg">

    <!-- Container fluid Starts -->
    <div class="container-fluid">
        {% if vul_obj %}
    	    <div class="top-bar clearfix app-vulnerability-width">
                <div class="row gutter">
                    <div class="col-lg-8 col-md-4 col-sm-4 col-xs-12">
                        <div class="page-title">
                            <h3>{{vul_obj.title}}</h3>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row starts -->
            <div class="row-gutter">
            	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            		<div class="panel app-vul-width app-vul-margin">
            			<div class="panel-heading">
            				<h3>Description</h3>
            			</div>
						<div class="panel-body">
            				{% autoescape off %}
            					<pre class="markdown-css">
            						{{ vul_obj.formatted_description|safe }}
            					</pre>
            				{% endautoescape %}
            			</div>
            		</div>
            	</div>
            </div>
            <!-- Row ends -->
            {% if vul_obj.formatted_remediation %}
            <!-- Row starts -->
            <div class="row-gutter">
            	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            		<div class="panel app-vul-width app-vul-margin">
            			<div class="panel-heading">
            				<h3>Remediation</h3>
            			</div>
            			<div  class="panel-body">
            				{% autoescape off %}
            					<pre class="markdown-css">
            						{{ vul_obj.formatted_remediation|safe }}
            					</pre>
            				{% endautoescape %}
            			</div>
            		</div>
            	</div>
            </div>
            <!-- Row ends -->
            {% endif %}

            <!-- Row starts -->
            {% if vul_obj.formatted_evidence %}
            <div class="row-gutter">
            	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            		<div class="panel app-vul-width app-vul-margin">
            			<div class="panel-heading">
            				<h3>Evidence</h3>
            			</div>
            			<div class="panel-body">
            				{% autoescape off %}
            					<pre class="markdown-css">
            						{{ vul_obj.formatted_evidence|safe }}
            					</pre>
            				{% endautoescape %}
            			</div>
            		</div>
            	</div>
            </div>
            {% endif %}
            <!-- Row ends -->

            <!-- Row starts -->
            <div class="row-gutter">
            	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            		<div class="panel app-vul-width app-vul-margin">
            			<div class="panel-heading">
            				<h3>Affected Hosts</h3>
            			</div>
            			<div class="panel-body">
                            <div class="table-responsive col-lg-10 col-md-10 app-vul-host-width">
								<table class="table-bordered table-hover table-condensed no-margin fixed">
									<thead>
            							<tr>
            								<th class="affected_padding">Last Seen</th>
            								<th class="affected_padding">Created</th>
                                            <th class="affected_padding">Virtue Id</th>
            							</tr>
            						</thead>
            						<tbody>
                                        {% for vul in app_vul %}
            							<tr>
            								<td>{{vul.modified_date}}</td>
            								<td>{{vul.created}}</td>
                                            <td>{{vul.virtue_id}}</td>
            							</tr>
                                        {% endfor %}
            						</tbody>
            					</table>
            				</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Row ends -->
        {% else %}
        <h3>Vulnerabilities details not found</h3>
        {% endif %}

		</div>
		<!-- Container fluid ends -->

	</div>
	<!-- Dashboard Wrapper End -->
{% endblock %}
