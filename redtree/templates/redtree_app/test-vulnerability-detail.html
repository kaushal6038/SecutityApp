{% extends 'base.html' %}
{% load markup_tags %}
{% block title %}
	<title>Test Vulnerability - {{vulnerability.title}}</title>
{% endblock %}

{% block content %}
	<!-- Dashboard Wrapper Start -->
	<div class="dashboard-wrapper dashboard-wrapper-lg">

		<!-- Container fluid Starts -->
		<div class="container-fluid">

            <div class="top-bar clearfix vulnerability-width">
                <div class="row gutter">
                    <div class="col-lg-8 col-md-4 col-sm-4 col-xs-12">
                        <div class="page-title">
                            <h3>{{ vulnerability.title}}</h3>
                        </div>
                    </div>
                </div>
            </div>

			<!-- Row starts -->
			<div class="row gutter">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="panel vulnerability-width">
                        <div class="panel-heading">
                            <h3>Description</h3>
                        </div>
						<div class="panel-body">
							{% autoescape off %}
								<pre class="markdown-css">
	                            	{{ vulnerability.formatted_description|safe }}
	                        	</pre>
							{% endautoescape %}
						</div>
					</div>
				</div>
			</div>
			<!-- Row ends -->
            <!-- Row starts -->
			<div class="row gutter">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="panel vulnerability-width">
                        <div class="panel-heading">
                            <h3>Remediation</h3>
                        </div>
						<div class="panel-body">
							{% autoescape off %}
								<pre class="markdown-css">
 	                          		{{ vulnerability.formatted_remediation|safe }}
 	                          	</pre>
							{% endautoescape %}
						</div>
					</div>
				</div>
			</div>
			<!-- Row ends -->
            <!-- Row starts -->
			<div class="row gutter">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="panel vulnerability-width">
                        <div class="panel-heading">
                            <h3>Affected Hosts</h3>
                        </div>
						<div class="panel-body">
                            <div class="table-responsive col-lg-10 col-md-10 vulnerability-host-width">
								<table class="table-bordered table-hover table-condensed no-margin fixed">
									<thead>
										<tr>
											<th>Host</th>
											<th>Port</th>
											{% if banner %}
												<th>Banner</th>
											{% endif %}
											<th>Created</th>
											<th>Detail</th>
											<th>Action</th>
										</tr>
									</thead>
									<tbody>
									{% for host in affected_hosts %}
										<tr>
											<td>
												{{host.host_ip}}
											</td>
											<td>{{ host.port }}</td>
											{% if banner %}
												<td>{{host.banner}}</td>
											{% endif %}
											<td>
												{{ host.created|date:"M d, Y" }}
											</td>
											<td>
												<center>
													<a href="/queue/{{host.virtue_id}}/{{host.id}}">
														view
													</a>
											</center>
											</td>
											<td>
												<a href="/queue/{{host.id}}/approve" class="btn btn-danger btn-xs">
													Approve
												</a>
												<a href="/queue/{{ vulnerability.virtue_id}}/{{host.id}}/edit" class="btn btn-info btn-xs">Edit</a>
												<a href="/queue-vulnerability-delete/{{host.virtue_id}}/{{host.id}}" class="btn btn-danger btn-xs">Delete</a>
											</td>
										</tr>
									{% endfor %}
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Row ends -->



		</div>
		<!-- Container fluid ends -->

	</div>
	<!-- Dashboard Wrapper End -->
{% endblock %}

{% block script %}
	<script src="/static/js/ipsdata.js"></script>
	<script src="/static/js/jquery.growl.js"></script>
{% endblock %}