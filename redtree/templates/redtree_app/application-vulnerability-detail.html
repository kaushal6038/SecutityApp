{% extends 'base.html' %}
{% load markup_tags %}
{% block title %}
	<title>Application Vulnerability - {{applicationvulnerability.title}}</title>
{% endblock %}

{% block content %}
<!-- Dashboard Wrapper Start -->
	<div class="dashboard-wrapper dashboard-wrapper-lg">
		<!-- Container fluid Starts -->
		<div class="container-fluid">
        {% if applicationvulnerability %}
            <div class="top-bar clearfix app-vulnerability-width">
                <div class="row gutter">
                    <div class="col-lg-8 col-md-4 col-sm-4 col-xs-12">
                        <div class="page-title">
                            <h3>{{ applicationvulnerability.title}}</h3>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row starts -->
            <div class="row-gutter">
            	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            		<div class="panel app-vulnerability-width app-vulnerability-margin">
            			<div class="panel-heading">
            				<h3>Description</h3>
            			</div>
            			<div class="panel-body">
            				{% autoescape off %}
            					<span class="markdown-css">
            						{{ applicationvulnerability.formatted_description|safe }}
            					</span>
            				{% endautoescape %}
            			</div>
            		</div>
            	</div>
            </div>
            <!-- Row ends -->

            <!-- Row starts -->
            {% if applicationvulnerability.formatted_remediation %}
            <div class="row-gutter">
            	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            		<div class="panel app-vulnerability-width app-vulnerability-margin">
            			<div class="panel-heading">
            				<h3>Remediation</h3>
            			</div>
            			<div class="panel-body">
            				{% autoescape off %}
            					<span class="markdown-css">
            						{{ applicationvulnerability.formatted_remediation|safe }}
            					</span>
            				{% endautoescape %}
            			</div>
            		</div>
            	</div>
            </div>
            {% endif %}
            <!-- Row ends -->

            <!-- Row starts -->
            {% if applicationvulnerability.formatted_evidence %}
            <div class="row-gutter">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="panel app-vulnerability-width app-vulnerability-margin">
                        <div class="panel-heading">
                            <h3>Evidence</h3>
                        </div>
                        <div class="panel-body">
                            {% autoescape off %}
                                <pre class="markdown-css">
                                    {{ applicationvulnerability.formatted_evidence|safe }}
                                </pre>
                            {% endautoescape %}
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
            <!-- Row ends -->

            <!-- Row starts -->
			<div class="row gutter">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="panel app-vulnerability-width">
                        <div class="panel-heading">
                            <h3>Affected Hosts</h3>
                        </div>
						<div class="panel-body">
                            <div class="table-responsive col-lg-10 col-md-10 app-vulnerability-host-width">
								<table class="table-bordered table-hover table-condensed no-margin fixed">
									<thead>
										<tr>
                                            {% if show_application %}
                                                <th>Application URL</th>
                                            {% endif %}
											<th>Last Seen</th>
											<th>Created</th>
											<th>Action</th>
										</tr>
									</thead>	
									<tbody>
										{% for host in app_vulnerability_obj %}
										<tr> 
                                            {% if show_application %}
                                                <td>
                                                    {{host.application}}
                                                </td>
                                            {% endif %}
											<td>
												{{host.modified_date}}
											</td>
											<td>
												{{host.created}}
											</td>
											<td>
                                                {% if show_application %}
                                                <a href="/application-vulnerabilities/edit/{{host.id}}/" class="btn btn-info btn-xs">Edit</a>
                                                {% endif %}
												<a href="/application-vulnerability/delete/{{host.id}}/" class="btn btn-danger btn-xs">Delete</a>
											</td>
										</tr>
									{% endfor %}
									</tbody>
								</table>
                                {% if app_vulnerability_obj.has_other_pages %}
                                    <ul class="pagination">
                                        {% if app_vulnerability_obj.has_previous %}
                                            <li>
                                                <a href="?page={{ app_vulnerability_obj.previous_page_number }}">
                                                    &laquo;
                                                </a>
                                            </li>
                                        {% else %}
                                            <li class="disabled"><span>&laquo;</span></li>
                                        {% endif %}
                                        {% for i in app_vulnerability_obj.paginator.page_range %}
                                            {% if app_vulnerability_obj.number == i %}
                                                <li class="active">
                                                    <span>
                                                        {{ i }}
                                                        <span class="sr-only">
                                                            (current)
                                                        </span>
                                                    </span>
                                                </li>
                                            {% else %}
                                                <li><a href="?page={{ i }}">{{ i }}</a></li>
                                            {% endif %}
                                        {% endfor %}
                                        {% if app_vulnerability_obj.has_next %}
                                            <li>
                                                <a href="?page={{ app_vulnerability_obj.next_page_number }}">
                                                    &raquo;
                                                </a>
                                            </li>
                                        {% else %}
                                            <li class="disabled"><span>&raquo;</span></li>
                                        {% endif %}
                                    </ul>
                                {% endif %}
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Row ends -->
        {% else %}
         <h3>No Record Found</h3>
        {% endif %}
		</div>
		<!-- Container fluid ends -->

	</div>
	<!-- Dashboard Wrapper End -->
{% endblock %}
