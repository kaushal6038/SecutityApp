{% extends 'base.html' %}
{% block title %}
	<title>RedTree - Add New Vulnerability</title>
{% endblock %}

{% block extracss %}
	<link href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" rel="Stylesheet"></link>
	<link href="/static/markdownx/markdownx.css" type="text/css" media="all" rel="stylesheet" />
{% endblock %}

{% block content %}
	<!-- Dashboard Wrapper Start -->
	<div class="dashboard-wrapper dashboard-wrapper-lg">

		<!-- Container fluid Starts -->
		<div class="container-fluid">

			<!-- Row Starts -->
				<div class="row">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="panel">
							<div class="panel-heading">
								<h4>Create New Vulnerability</h4>
								{% if form.non_field_errors %}
									{% for error in form.non_field_errors %}
										<div class="alert alert-danger">
											<button type="button" class="close" style="color:black;" data-dismiss="alert">x</button>
											<strong>{{ error|escape }}</strong>
										</div>
									{% endfor %}
								{% endif %}
								{% if message %}
									{% for error in message %}
										<div class="alert alert-danger">
											<button type="button" class="close" style="color:black;" data-dismiss="alert">x</button>
											<strong>{{ error }}</strong>
										</div>
									{% endfor %}
								{% endif %}
							</div>
							<div class="panel-body">
								<form  method="post" id="vulnerability">{% csrf_token %}
									<div class="form-group">
										<div class="row gutter">
											<div class="col-lg-4 col-md-4">
												<label class="control-label">
													Vulnerability Type
												</label>
												<select name="vulnerability_type" class="form-control" id="vul-type" required>
													<option value=""></option>
													<option value="network">
														network
													</option>
													<option value="application">
														application
													</option>
												</select>
											</div>
											<div class="col-lg-4 col-md-4" id="app-url-div" hidden>
												<label class="control-label">
													Application Urls
												</label>
												<select name="application" class="form-control" id="id_application">
													<option value=""></option>
												</select>
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="row gutter">
											<div class="col-md-12">
												<label class="control-label">Title</label>
												{{form.title}}
												<input type="hidden" name="virtue_id" value="" id="virtue_id">
											</div>
										</div>
									</div>

									<div class="form-group">
										<label class="control-label">Description</label>
										{{form.description}}
									</div>
									<div class="form-group">
										<label class="control-label">Remediation</label>
										{{form.remediation}}
									</div>
									<div class="form-group">
										<label class="control-label">Evidence</label>
										{{form.evidence}}
									</div>
									<div class="row">
										<div class="form-group col-lg-4 col-md-4">
											<label class="control-label">Risk</label>
											{{form.risk}}
										</div>
										<div class="form-group col-lg-4 col-md-4" id="port_section">
											<label class="control-label">Port</label>
											{{form.port}}
										</div>
									</div>

									<div class="row" id="host_row">

										<div class="form-group col-lg-2 col-md-2">
											<label class="control-label">Host</label>
											<input type="text"  autocomplete="off" class="form-control" id="host" />
											
										</div>

										<div class="form-group col-lg-1 col-md-1">
											<button class="btn btn-default" id="save" onclick="hostData();" type="button" style="margin-top:30px;">Add</button>
										</div>
										<div class="form-group col-lg-9  col-md-9">
											<label class="control-label">Added Hosts</label>
											{{ form.host }}
											<span id="host-error" style="color: red;" hidden>This field is required.</span>
										</div>
									</div>
									<div class="form-group">
										<button type="submit" class="btn btn-success">Submit</button>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
				<!-- Row Ends -->
		</div>
		<!-- Container fluid ends -->

	</div>

	<!-- Dashboard Wrapper End -->
{% endblock %}
{% block script %}
	<script src="https://code.jquery.com/jquery-migrate-3.0.0.min.js" ></script>
	<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js" ></script>
   	<script src="/static/js/custom.js"></script>
   	<script src="/static/js/data-autocomplete.js"></script>
	<script type="text/javascript" src="/static/markdownx/markdownx.js"></script>
	<script type="text/javascript" src="/static/js/vulnerability.js"></script>
	<script type="text/javascript">
		var host_array=[];
		$('#host_array').val('');
	</script>
{% endblock %}